# 基于Elasticsearch的日志监控报警系统

## 问题背景

现在最流行的日志系统基本都是基于Elastic Stack(ELK), 基本解决了日志的采集，存储，查询分析的需求。但是对日志的监控报警
这块并没有很多选项，用的比较多的是ElastAlert。ElastAlert在初期基本能满足需求，但是随着监控配置越来越多，数量到达200+的时候，
面临了一些棘手的问题:

* 配置管理成本较高

配置文件多了之后，管理起来相当难受。

* 统一的监控调度策略，过于死板

所有监控只能统一调度频次，无法根据具体情况配置。不同的监控配置不同的调度策略还是很有需求的。

* 监控相互影响很大

在监控多了之后，一些监控配置不合理，导致查询很慢，影响所有监控的执行。甚至有时候进程直接崩溃。

* 监控过程不好追溯

经常有同事来找问，本来应该报警的，为什么某个时间点没有报警，这时候事后做追溯非常困难。

* 只能监控一个集群的数据

需要监控的数据很可能不都在一个集群。为了监控多集群数据，就需要部署多个ElastAlert，又增加了维护成本。

* 报警消息内容定制不方便

## 解决思路

为了解决这些问题，开始设想开发一个满足需求的最小集的监控系统的成本有多高。首先我们定义一个最小集监控系统具备的
功能和对应的成本：

* 各个监控独立调度

* 配置管理

* 实现最简单实用的频次规则监控

## 结构设计

## 技术选型